<div class="register-form-container">
    <div class="glass">
        <form class="register-form" [formGroup]="form" (ngSubmit)="submit()" novalidate>

            <div class="register-form-header form-header">
                <h2 class="title">
                    Register
                </h2>
            </div>

            <div class="form-input-wrapper">
                <div class="first-name-input-wrapper">
                    <label for="firstName">First name</label>
                    <input placeholder="" type="text" formControlName="firstName" autocomplete="given-name" />

                    @if (form.controls.firstName.touched && form.controls.firstName.invalid) {
                        <small class="err">
                            <app-error-message [message]="'Fisrt name is required.'"/>
                        </small>
                    }
                </div>

                <div class="last-name-input-wrapper">
                    <label for="lastName">Last name</label>
                    <input placeholder="" type="text" formControlName="lastName" autocomplete="family-name" />

                    @if (form.controls.lastName.touched && form.controls.lastName.invalid) {
                        <small class="err">
                            <app-error-message [message]="'Last name is required.'"/>
                        </small>
                    }
                </div>

                <div class="email-input-wrapper">
                    <label for="email">Email</label>
                    <input placeholder="" type="email" formControlName="email" autocomplete="email" />

                    @if (form.controls.email.touched && form.controls.email.invalid) {
                        <small class="err">
                            @if (form.controls.email.errors?.['required']) { 
                                <app-error-message [message]="'Email is required.'"/>
                            }
                            @if (form.controls.email.errors?.['email']) { 
                                <app-error-message [message]="'Enter a valid email.'"/>
                            }
                        </small>
                    }
                </div>

                <div class="password-input-wrapper">
                    <label for="password">Password</label>
                    <input placeholder="" type="password" formControlName="password" autocomplete="new-password" />

                    @if (form.controls.password.touched && form.controls.password.invalid) {
                        <small class="err">
                            <app-error-message [message]="'Password is required.'"/>
                        </small>
                    }
                </div>

                <div class="roles-wrapper">
                    <div class="basic-roles-wrapper">
                        <label for="basicRoles">Basic role</label>
                        <div class="roles_grid">
                            @for (r of basicRoles; track r.key) {
                                <button
                                    type="button"
                                    class="role-tile"
                                    [class.selected]="isSelectedBasic(r.key)"
                                    (click)="toggleRole(r.key)"
                                    aria-pressed="{{ isSelectedBasic(r.key) }}"
                                >
                                    <mat-icon [svgIcon]="r.icon"></mat-icon>
                                    <span class="label">{{ r.label }}</span>
                                </button>
                            }
                        </div>

                        @if ((form.controls.basicRoles.touched || form.controls.basicRoles.dirty) && form.controls.basicRoles.invalid) {
                            <small class="err">
                                <app-error-message [message]="'At least one basic role has to be selected.'"/>
                            </small>
                        }
                    </div>

                    <div class="extra-roles-wrapper">
                        <label for="extraRoles">Extra roles</label>
                        <div class="roles_grid">
                            @for (r of extraRoles; track r.key) {
                                <button
                                    type="button"
                                    class="role-tile"
                                    [class.selected]="isSelectedExtra(r.key)"
                                    (click)="toggleRole(r.key)"
                                    aria-pressed="{{ isSelectedExtra(r.key) }}"
                                >
                                    <mat-icon [svgIcon]="r.icon"></mat-icon>
                                    <span class="label">{{ r.label }}</span>
                                </button>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- @if (form.errors?.['auth']) {
                <div class="err">
                    <app-error-message [message]="'Invalid email or password.'"/>
                </div>
            } -->


            <button class="register-btn" type="submit" [disabled]="form.invalid || loading">
                {{ loading ? 'Registringâ€¦' : 'Register' }}
            </button>
        </form>
    </div>

    <!-- <div class="lower-banner-wrapper">
        <div class="lower-banner">
            <div class="err">
                <app-error-message [message]="'For employees only.'"/>
            </div>
            <div>
                <span>
                    Back to
                </span>
                <a routerLink="/landing">
                    Landing
                </a>
            </div>
        </div>
    </div> -->
</div>
